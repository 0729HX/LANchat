# 内网聊天工具

基于 Python Flask 和 Socket.IO 开发的高性能内网聊天工具，支持实时消息、大文件传输和媒体文件预览功能。

## 功能特点

- 💬 实时消息传递
  - 即时消息推送
  - 在线用户统计
  - IP地址显示

- 📁 高性能文件传输
  - 支持大文件传输（视频、文档等）
  - 多线程并行传输
  - 自动分片和断点续传
  - 实时传输速度显示
  - 智能错误重试机制

- 🖼️ 图片处理优化
  - 智能图片压缩
  - 自适应压缩质量
  - 保持图片比例
  - 加载动画提示
  - 点击放大预览

- 📎 文件管理功能
  - 拖放上传支持
  - 多种文件格式支持
    - 图片（jpg、png、gif等）
    - 视频文件
    - PDF文档
    - Word文档
    - 文本文件
  - 文件大小显示
  - 传输进度显示

- 🎯 用户体验优化
  - 简洁美观的界面
  - 支持回车快捷发送
  - 实时传输状态反馈
  - 文件传输速度显示

## 技术特性

### 后端技术
- Python Flask
- Flask-SocketIO
- Werkzeug
- 多线程并行处理
- 分片传输机制

### 前端技术
- HTML5
- CSS3
- JavaScript
- Socket.IO Client
- Canvas图片处理
- 文件流处理

### 性能优化
- 文件传输
  - 1MB 分片大小
  - 5线程并行传输
  - 自动错误重试（最多3次）
  - 超时检测（10秒）
  - 200ms 进度更新频率

- 图片压缩
  - 自适应压缩算法
    - 5MB以上：30%质量
    - 2MB-5MB：40%质量
    - 1MB-2MB：50%质量
    - 500KB-1MB：60%质量
    - 500KB以下：70%质量
  - 最大尺寸限制：1200px

## 安装步骤

1. 克隆项目：
```bash
git clone https://github.com/0729HX/LANchat.git
cd 内网聊天
```

2. 安装Python依赖：
```bash
pip install -r requirements.txt
```

3. 运行应用：
```bash
python app.py
```

4. 访问应用：
- 本机访问：`http://localhost:5000`
- 局域网访问：`http://[服务器IP]:5000`

## 使用说明

### 发送消息
- 在输入框输入消息
- 点击发送按钮或按回车键发送

### 发送文件
- 方式一：点击回形针图标选择文件
- 方式二：直接拖放文件到聊天区域
- 支持的文件类型：
  - 图片（自动压缩）
  - 视频文件
  - PDF文档
  - Word文档
  - 文本文件

### 传输状态
- 文件名和大小显示
- 实时传输速度
- 进度百分比
- 平均传输速度

## 配置说明

### 服务器配置
- 端口：5000（可在 `app.py` 中修改）
- 最大文件大小：16MB（可在 `app.py` 中修改）

### 传输配置
在 `static/js/chat.js` 中可修改：
```javascript
const CHUNK_SIZE = 1024 * 1024;    // 分片大小
const MAX_PARALLEL_CHUNKS = 5;      // 并行传输数
```

### 图片压缩配置
```javascript
const IMAGE_MAX_SIZE = 1200;        // 最大图片尺寸
const IMAGE_QUALITY = 0.5;          // 默认压缩质量
```

## 注意事项

1. 确保防火墙允许5000端口通信
2. 建议在内网环境使用
3. 大文件传输时请保持网页打开
4. 目前不支持历史消息保存

## 性能建议

1. 在千兆网络环境下使用
2. 服务器建议配置：
   - CPU：双核及以上
   - 内存：4GB及以上
   - 网络：千兆网卡
3. 客户端建议：
   - 现代浏览器（Chrome、Firefox、Edge等）
   - 稳定的网络连接

## 开发计划

- [ ] 添加用户昵称功能
- [ ] 支持消息历史记录
- [ ] 添加文件预览功能
- [ ] 支持更多文件格式
- [ ] 添加表情包功能
- [ ] 增加文件传输队列
- [ ] 添加传输速度限制选项
- [ ] 支持文件夹上传 